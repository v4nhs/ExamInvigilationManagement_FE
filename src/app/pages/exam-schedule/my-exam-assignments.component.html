<div class="my-exam-assignments-container">
  <!-- Header -->
  <div class="assignments-header">
    <div class="header-content">
      <h1>üìÖ L·ªãch Thi C·ªßa T√¥i</h1>
      <p class="subtitle">C√°c l·ªãch thi ƒë∆∞·ª£c ph√¢n c√¥ng cho <strong>{{ currentUserName }}</strong></p>
    </div>
    <button class="btn btn-primary" (click)="loadMyExamAssignments()">
      <i class="icon">üîÑ</i> L√†m m·ªõi
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="alert alert-danger">
    <strong>‚ö†Ô∏è L·ªói:</strong> {{ error }}
    <button class="btn-close" (click)="error = null">√ó</button>
  </div>

  <!-- Main Content -->
  <div *ngIf="!loading && !error" class="assignments-content">
    <!-- Search and Sort Bar -->
    <div class="controls-bar">
      <div class="search-box">
        <input
          type="text"
          placeholder="üîç T√¨m ki·∫øm theo t√™n m√¥n h·ªçc, m√£ m√¥n ho·∫∑c ph√≤ng..."
          [(ngModel)]="searchQuery"
          (keyup)="onSearch()"
          class="form-control"
        />
      </div>

      <div class="sort-controls">
        <select [(ngModel)]="sortBy" (change)="onSortChange()" class="form-control">
          <option value="date">S·∫Øp x·∫øp theo ng√†y</option>
          <option value="courseName">S·∫Øp x·∫øp theo m√¥n h·ªçc</option>
        </select>

        <select [(ngModel)]="sortOrder" (change)="onSortChange()" class="form-control">
          <option value="desc">M·ªõi nh·∫•t tr∆∞·ªõc</option>
          <option value="asc">C≈© nh·∫•t tr∆∞·ªõc</option>
        </select>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="filteredSchedules.length === 0 && !loading" class="empty-state">
      <div class="empty-icon">üì≠</div>
      <h3>Kh√¥ng c√≥ l·ªãch thi n√†o</h3>
      <p>B·∫°n ch∆∞a ƒë∆∞·ª£c ph√¢n c√¥ng l·ªãch thi n√†o. Vui l√≤ng li√™n h·ªá ph√≤ng qu·∫£n l√Ω ƒë√†o t·∫°o.</p>
    </div>

    <!-- Exams Table -->
    <div *ngIf="paginatedSchedules.length > 0" class="table-wrapper">
      <table class="exams-table">
        <thead>
          <tr>
            <th>M√¥n H·ªçc</th>
            <th>M√£ M√¥n</th>
            <th>Ng√†y Thi</th>
            <th>Th·ªùi Gian</th>
            <th>Ph√≤ng Thi</th>
            <th>Lo·∫°i Thi</th>
            <th>S·ªë Sinh Vi√™n</th>
            <th>Tr·∫°ng Th√°i</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let schedule of paginatedSchedules" class="exam-row">
            <td class="course-name">{{ schedule.courseName }}</td>
            <td class="course-code">{{ schedule.courseCode }}</td>
            <td class="exam-date">
              <div class="date-box">{{ schedule.examDate }}</div>
              <div class="day-text">{{ schedule.examDay }}</div>
            </td>
            <td class="exam-time">
              {{ schedule.examTime }}
              <span *ngIf="schedule.endTime" class="end-time">- {{ schedule.endTime }}</span>
            </td>
            <td class="room">{{ schedule.room }}</td>
            <td class="exam-type">
              <span class="badge badge-primary">{{ schedule.examType }}</span>
            </td>
            <td class="student-count">
              <span class="count-badge">{{ schedule.studentCount }}</span>
            </td>
            <td class="status">
              <span [class]="'badge ' + getStatusBadgeClass(schedule.status)">
                {{ getStatusText(schedule.status) }}
              </span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div *ngIf="totalPages > 1" class="pagination-wrapper">
      <div class="pagination-info">
        Hi·ªÉn th·ªã <strong>{{ (currentPage - 1) * pageSize + 1 }}</strong> ƒë·∫øn <strong>{{ Math.min(currentPage * pageSize, totalItems) }}</strong> trong <strong>{{ totalItems }}</strong> l·ªãch thi
      </div>

      <nav class="pagination">
        <button
          [disabled]="currentPage === 1"
          (click)="changePage(currentPage - 1)"
          class="btn btn-sm"
        >
          ‚Üê Tr∆∞·ªõc
        </button>

        <div class="page-numbers">
          <button
            *ngFor="let page of pageArray"
            [class.active]="page === currentPage"
            (click)="changePage(page)"
            class="page-btn"
          >
            {{ page }}
          </button>
        </div>

        <button
          [disabled]="currentPage === totalPages"
          (click)="changePage(currentPage + 1)"
          class="btn btn-sm"
        >
          Sau ‚Üí
        </button>
      </nav>
    </div>

    <!-- Summary Info -->
    <div *ngIf="filteredSchedules.length > 0" class="summary-info">
      <div class="info-card">
        <div class="info-icon">üìã</div>
        <div class="info-text">
          <strong>{{ filteredSchedules.length }}</strong> l·ªãch thi ƒë∆∞·ª£c ph√¢n c√¥ng
        </div>
      </div>
    </div>
  </div>
</div>
