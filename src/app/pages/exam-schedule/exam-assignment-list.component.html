<div class="assignment-list-container">
  <h2>Ph√¢n c√¥ng coi thi</h2>
  
  <div *ngIf="error" class="error-message">
    <p>{{ error }}</p>
    <button class="retry-btn" (click)="fetchSchedules()">Th·ª≠ l·∫°i</button>
  </div>

  <div class="search-filter-section" *ngIf="!error && !loading">
    <div class="search-box">
      <i class="search-icon">üîç</i>
      <input 
        type="text" 
        placeholder="T√¨m ki·∫øm theo t√™n HP, m√£ HP, ph√≤ng..."
        [(ngModel)]="searchQuery"
        (input)="onSearchChange()"
        class="search-input"
      />
      <button *ngIf="searchQuery" class="clear-btn" (click)="clearSearch()">‚úï</button>
    </div>

    <div class="sort-controls">
      <label for="sortBy">S·∫Øp x·∫øp theo:</label>
      <select [(ngModel)]="sortBy" (change)="onSortChange()" id="sortBy" class="sort-select">
        <option value="date">Ng√†y thi</option>
        <option value="courseName">T√™n HP</option>
      </select>

      <select [(ngModel)]="sortOrder" (change)="onSortChange()" class="sort-select">
        <option value="desc">M·ªõi nh·∫•t</option>
        <option value="asc">C≈© nh·∫•t</option>
      </select>
    </div>
  </div>

  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
  </div>

  <div class="table-responsive" *ngIf="!error && !loading">
    <table class="assignment-table">
      <thead>
        <tr>
          <th>#</th>
          <th>M√£ HP</th>
          <th>T√™n HP</th>
          <th>Th·ª©</th>
          <th>Ng√†y thi</th>
          <th>Gi·ªù thi</th>
          <th>Gi·ªù k·∫øt th√∫c</th>
          <th>H√¨nh th·ª©c thi</th>
          <th>S·ªë c√°n b·ªô coi thi</th>
          <th>H√†nh ƒë·ªông</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngIf="!loading && paginatedSchedules.length === 0" class="no-data">
          <td colspan="10" class="text-center">Kh√¥ng c√≥ l·ªãch thi n√†o</td>
        </tr>
        <tr *ngFor="let schedule of paginatedSchedules; let i = index">
          <td>{{ (currentPage - 1) * pageSize + i + 1 }}</td>
          <td>{{ schedule.courseCode }}</td>
          <td class="course-name">{{ schedule.courseName }}</td>
          <td>{{ schedule.examDay }}</td>
          <td>{{ schedule.examDate | date: 'dd/MM/yyyy' }}</td>
          <td>{{ schedule.examTime }}</td>
          <td>{{ schedule.endTime }}</td>
          <td>
            <span class="exam-type-badge" [ngClass]="'type-' + schedule.examType.toLowerCase()">
              {{ schedule.examType === 'WRITTEN' ? 'Thi vi·∫øt' : 'H√¨nh th·ª©c kh√°c' }}
            </span>
          </td>
          <td>{{ schedule.invigilatorCount }}</td>
          <td>
            <button class="action-btn assign-btn" (click)="goToAssignment(schedule.id)">
              Ph√¢n c√¥ng
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Pagination Controls -->
    <div class="pagination-container" *ngIf="totalPages > 1">
      <div class="pagination-info">
        <p>Hi·ªÉn th·ªã {{ (currentPage - 1) * pageSize + 1 }} ƒë·∫øn {{ Math.min(currentPage * pageSize, totalItems) }} trong {{ totalItems }} m·ª•c</p>
      </div>

      <div class="pagination-controls">
        <button 
          class="pagination-btn" 
          (click)="previousPage()" 
          [disabled]="currentPage === 1">
          ‚Üê Tr∆∞·ªõc
        </button>

        <div class="page-numbers">
          <button 
            *ngFor="let page of getPageNumbers()" 
            class="page-btn" 
            [class.active]="page === currentPage"
            (click)="goToPage(page)">
            {{ page }}
          </button>
        </div>

        <button 
          class="pagination-btn" 
          (click)="nextPage()" 
          [disabled]="currentPage === totalPages">
          Ti·∫øp ‚Üí
        </button>
      </div>
    </div>
  </div>
</div>
